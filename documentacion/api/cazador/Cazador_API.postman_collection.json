{
	"info": {
		"_postman_id": "cazador-api-collection",
		"name": "API Cazador - CRM Inmobiliaria",
		"description": "Colecci√≥n completa de endpoints para la API Cazador. Incluye autenticaci√≥n, proyectos, clientes, reservas y b√∫squeda de documentos.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "cazador-api"
	},
	"item": [
		{
			"name": "üîê Autenticaci√≥n",
			"item": [
				{
					"name": "Iniciar Sesi√≥n",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.success && jsonData.data.token) {",
									"        pm.environment.set(\"auth_token\", jsonData.data.token);",
									"        pm.environment.set(\"user_id\", jsonData.data.user.id);",
									"        console.log(\"Token guardado: \" + jsonData.data.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"cazador@example.com\",\n    \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"auth",
								"login"
							]
						},
						"description": "Inicia sesi√≥n y obtiene un token JWT. El token se guarda autom√°ticamente en la variable de entorno `auth_token`."
					},
					"response": []
				},
				{
					"name": "Obtener Usuario Autenticado",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/auth/me",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"auth",
								"me"
							]
						},
						"description": "Obtiene la informaci√≥n del usuario autenticado."
					},
					"response": []
				},
				{
					"name": "Cerrar Sesi√≥n",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"auth",
								"logout"
							]
						},
						"description": "Invalida el token JWT actual."
					},
					"response": []
				},
				{
					"name": "Renovar Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.success && jsonData.data.token) {",
									"        pm.environment.set(\"auth_token\", jsonData.data.token);",
									"        console.log(\"Token renovado: \" + jsonData.data.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/auth/refresh",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"auth",
								"refresh"
							]
						},
						"description": "Renueva el token JWT actual. El nuevo token se guarda autom√°ticamente."
					},
					"response": []
				},
				{
					"name": "Cambiar Contrase√±a",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"current_password\": \"password123\",\n    \"new_password\": \"newpassword456\",\n    \"new_password_confirmation\": \"newpassword456\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/auth/change-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"auth",
								"change-password"
							]
						},
						"description": "Cambia la contrase√±a del usuario autenticado."
					},
					"response": []
				}
			],
			"description": "Endpoints para autenticaci√≥n, gesti√≥n de sesi√≥n y perfil de usuario."
		},
		{
			"name": "üèóÔ∏è Proyectos",
			"item": [
				{
					"name": "Listar Proyectos",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/projects?per_page=15&page=1&search=&project_type=&lote_type=&stage=&legal_status=&status=&district=&province=&region=&has_available_units=",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"projects"
							],
							"query": [
								{
									"key": "per_page",
									"value": "15",
									"description": "Elementos por p√°gina (m√°ximo 100)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "N√∫mero de p√°gina"
								},
								{
									"key": "search",
									"value": "",
									"description": "B√∫squeda en nombre, descripci√≥n, direcci√≥n, distrito, provincia",
									"disabled": true
								},
								{
									"key": "project_type",
									"value": "",
									"description": "Tipo de proyecto",
									"disabled": true
								},
								{
									"key": "lote_type",
									"value": "",
									"description": "Tipo de lote (normal, express)",
									"disabled": true
								},
								{
									"key": "stage",
									"value": "",
									"description": "Etapa (preventa, lanzamiento, venta_activa, cierre)",
									"disabled": true
								},
								{
									"key": "legal_status",
									"value": "",
									"description": "Estado legal",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"description": "Estado (activo, inactivo, suspendido, finalizado)",
									"disabled": true
								},
								{
									"key": "district",
									"value": "",
									"description": "Distrito",
									"disabled": true
								},
								{
									"key": "province",
									"value": "",
									"description": "Provincia",
									"disabled": true
								},
								{
									"key": "region",
									"value": "",
									"description": "Regi√≥n",
									"disabled": true
								},
								{
									"key": "has_available_units",
									"value": "",
									"description": "Solo proyectos con unidades disponibles (true/false)",
									"disabled": true
								}
							]
						},
						"description": "Obtiene una lista paginada de todos los proyectos disponibles."
					},
					"response": []
				},
				{
					"name": "Obtener Proyecto Espec√≠fico",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/projects/:id?units_per_page=15&include_units=true",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"projects",
								":id"
							],
							"query": [
								{
									"key": "units_per_page",
									"value": "15",
									"description": "Unidades por p√°gina (m√°ximo 100)"
								},
								{
									"key": "include_units",
									"value": "true",
									"description": "Incluir unidades en la respuesta"
								}
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID del proyecto"
								}
							]
						},
						"description": "Obtiene los detalles completos de un proyecto, incluyendo unidades disponibles paginadas."
					},
					"response": []
				},
				{
					"name": "Obtener Unidades de un Proyecto",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/projects/:id/units?per_page=15&page=1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"projects",
								":id",
								"units"
							],
							"query": [
								{
									"key": "per_page",
									"value": "15",
									"description": "Elementos por p√°gina (m√°ximo 100)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "N√∫mero de p√°gina"
								}
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID del proyecto"
								}
							]
						},
						"description": "Obtiene una lista paginada de unidades disponibles de un proyecto espec√≠fico. Solo devuelve unidades con estado 'disponible'."
					},
					"response": []
				}
			],
			"description": "Endpoints para consultar proyectos y unidades disponibles. Solo se muestran unidades con estado 'disponible'."
		},
		{
			"name": "üë• Clientes",
			"item": [
				{
					"name": "Listar Clientes",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/clients?per_page=15&page=1&search=&status=&type=&source=",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"clients"
							],
							"query": [
								{
									"key": "per_page",
									"value": "15",
									"description": "Elementos por p√°gina (m√°ximo 100)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "N√∫mero de p√°gina"
								},
								{
									"key": "search",
									"value": "",
									"description": "B√∫squeda en nombre, tel√©fono o n√∫mero de documento",
									"disabled": true
								},
								{
									"key": "status",
									"value": "",
									"description": "Estado del cliente",
									"disabled": true
								},
								{
									"key": "type",
									"value": "",
									"description": "Tipo de cliente",
									"disabled": true
								},
								{
									"key": "source",
									"value": "",
									"description": "Origen del cliente",
									"disabled": true
								}
							]
						},
						"description": "Obtiene una lista paginada de clientes asignados al cazador autenticado."
					},
					"response": []
				},
				{
					"name": "Obtener Cliente Espec√≠fico",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/clients/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"clients",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID del cliente"
								}
							]
						},
						"description": "Obtiene los detalles completos de un cliente espec√≠fico."
					},
					"response": []
				},
				{
					"name": "Crear Cliente",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Mar√≠a Gonz√°lez\",\n    \"phone\": \"+51912345678\",\n    \"document_type\": \"dni\",\n    \"document_number\": \"87654321\",\n    \"address\": \"Av. Los Olivos 789\",\n    \"birth_date\": \"1985-03-20\",\n    \"client_type\": \"comprador\",\n    \"source\": \"web\",\n    \"status\": \"nuevo\",\n    \"score\": 0,\n    \"notes\": \"Cliente interesado en proyectos de lotes\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/clients",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"clients"
							]
						},
						"description": "Crea un nuevo cliente y lo asigna autom√°ticamente al cazador autenticado."
					},
					"response": []
				},
				{
					"name": "Actualizar Cliente",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Carlos Rodr√≠guez Actualizado\",\n    \"phone\": \"+51987654321\",\n    \"status\": \"activo\",\n    \"score\": 90,\n    \"notes\": \"Cliente muy interesado, seguimiento activo\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/clients/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"clients",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID del cliente"
								}
							]
						},
						"description": "Actualiza la informaci√≥n de un cliente existente. Solo puedes actualizar clientes que te est√°n asignados o que creaste."
					},
					"response": []
				},
				{
					"name": "Obtener Opciones para Formularios",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/clients/options",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"clients",
								"options"
							]
						},
						"description": "Obtiene las opciones disponibles para campos de formularios (tipos de documento, estados, etc.)."
					},
					"response": []
				}
			],
			"description": "Endpoints para gestionar clientes. Los cazadores solo pueden ver y gestionar clientes que les est√°n asignados o que ellos mismos crearon."
		},
		{
			"name": "üé´ Reservas",
			"item": [
				{
					"name": "Listar Reservas",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations?per_page=15&page=1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations"
							],
							"query": [
								{
									"key": "per_page",
									"value": "15",
									"description": "Elementos por p√°gina (m√°ximo 100)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "N√∫mero de p√°gina"
								}
							]
						},
						"description": "Obtiene una lista paginada de reservas del cazador autenticado. Los cazadores normales solo ven sus propias reservas. Los administradores y l√≠deres ven todas las reservas."
					},
					"response": []
				},
				{
					"name": "Obtener Reserva Espec√≠fica",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID de la reserva"
								}
							]
						},
						"description": "Obtiene los detalles completos de una reserva espec√≠fica."
					},
					"response": []
				},
				{
					"name": "Crear Reserva",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"client_id\": 5,\n    \"project_id\": 2,\n    \"unit_id\": 10,\n    \"advisor_id\": 3,\n    \"reservation_date\": \"2024-01-15\",\n    \"expiration_date\": \"2024-02-15\",\n    \"reservation_amount\": 50000.00,\n    \"reservation_percentage\": 10.00,\n    \"payment_method\": \"transferencia\",\n    \"payment_reference\": \"TRF-123456\",\n    \"notes\": \"Cliente interesado en lote de 300m¬≤\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations"
							]
						},
						"description": "Crea una nueva reserva. La reserva se crea con estado 'activa' y la unidad permanece disponible hasta que se confirme con imagen."
					},
					"response": []
				},
				{
					"name": "Actualizar Reserva",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"reservation_amount\": 60000.00,\n    \"reservation_percentage\": 12.00,\n    \"payment_status\": \"parcial\",\n    \"notes\": \"Cliente realiz√≥ pago parcial\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations/:id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations",
								":id"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID de la reserva"
								}
							]
						},
						"description": "Actualiza una reserva existente. Solo se pueden actualizar reservas con estado 'activa'."
					},
					"response": []
				},
				{
					"name": "Confirmar Reserva",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "image",
									"type": "file",
									"src": [],
									"description": "Imagen del comprobante (jpeg, png, jpg, gif, webp, m√°x 10MB)"
								},
								{
									"key": "payment_status",
									"value": "pagado",
									"type": "text",
									"disabled": true
								},
								{
									"key": "payment_method",
									"value": "transferencia",
									"type": "text",
									"disabled": true
								},
								{
									"key": "payment_reference",
									"value": "TRF-123456",
									"type": "text",
									"disabled": true
								}
							]
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations/:id/confirm",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations",
								":id",
								"confirm"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID de la reserva"
								}
							]
						},
						"description": "Confirma una reserva subiendo la imagen del comprobante de pago. Esto cambia el estado a 'confirmada' y marca la unidad como 'reservado'."
					},
					"response": []
				},
				{
					"name": "Cancelar Reserva",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"cancel_note\": \"Cliente decidi√≥ no continuar con la compra por motivos personales\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations/:id/cancel",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations",
								":id",
								"cancel"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID de la reserva"
								}
							]
						},
						"description": "Cancela una reserva con una nota obligatoria. Libera la unidad a estado 'disponible'."
					},
					"response": []
				},
				{
					"name": "Convertir Reserva a Venta",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/cazador/reservations/:id/convert-to-sale",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"reservations",
								":id",
								"convert-to-sale"
							],
							"variable": [
								{
									"key": "id",
									"value": "1",
									"description": "ID de la reserva"
								}
							]
						},
						"description": "Convierte una reserva confirmada a una venta (Opportunity). Marca la unidad como 'vendido'."
					},
					"response": []
				}
			],
			"description": "Endpoints para gestionar reservas inmobiliarias. Los cazadores pueden crear, editar, confirmar, cancelar y convertir reservas a ventas."
		},
		{
			"name": "üîç Documentos",
			"item": [
				{
					"name": "Buscar Documento (DNI/RUC)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"document_type\": \"dni\",\n    \"document_number\": \"12345678\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/cazador/documents/search",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"cazador",
								"documents",
								"search"
							]
						},
						"description": "Busca informaci√≥n completa de una persona (DNI) o empresa (RUC) utilizando el servicio externo de Facturalahoy. El sistema verifica primero si el documento ya est√° registrado en la base de datos antes de realizar la b√∫squeda externa."
					},
					"response": []
				}
			],
			"description": "Endpoint para buscar informaci√≥n completa de personas (DNI) o empresas (RUC) utilizando el servicio externo de Facturalahoy."
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "https://tu-dominio.com",
			"type": "string"
		},
		{
			"key": "auth_token",
			"value": "",
			"type": "string"
		}
	]
}


